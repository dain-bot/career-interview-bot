<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ë©´ì ‘ê´€ ê¼¬ë¦¬ì§ˆë¬¸ ë´‡</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Pretendard:wght@400;600;700&display=swap');
        body { font-family: 'Pretendard', sans-serif; background-color: #f1f5f9; }
        .chat-container { height: calc(100vh - 320px); }
        .glass-morphism { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); }
        .loading-dots:after { content: ' .'; animation: dots 1s steps(5, start) infinite; }
        @keyframes dots { 
            0%, 20% { color: rgba(0,0,0,0); text-shadow: .5em 0 0 rgba(0,0,0,0), 1em 0 0 rgba(0,0,0,0); } 
            40% { color: #6366f1; text-shadow: .5em 0 0 rgba(0,0,0,0), 1em 0 0 rgba(0,0,0,0); } 
            60% { text-shadow: .5em 0 0 #6366f1, 1em 0 0 rgba(0,0,0,0); } 
            80%, 100% { text-shadow: .5em 0 0 #6366f1, 1em 0 0 #6366f1; } 
        }
    </style>
</head>
<body class="text-slate-800">

<div class="max-w-3xl mx-auto px-4 py-8">
    <!-- Header -->
    <header class="text-center mb-6">
        <div class="inline-block bg-indigo-100 text-indigo-700 px-4 py-1 rounded-full text-xs font-bold mb-2 tracking-wider uppercase">13th Sprint Career Mission</div>
        <h1 class="text-3xl font-black tracking-tight text-slate-900">ğŸ•µï¸ AI ë©´ì ‘ê´€ ê¼¬ë¦¬ì§ˆë¬¸ ë´‡</h1>
        <p class="mt-2 text-slate-500 text-sm font-medium">ê²½í—˜ ë¶„ì„ ì‹œíŠ¸ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì—¬ëŸ¬ë¶„ì˜ ë…¼ë¦¬ì  í—ˆì ì„ ì°¾ì•„ ì§ˆë¬¸ì„ ë˜ì§‘ë‹ˆë‹¤.</p>
    </header>

    <!-- API Key Entry (Security) -->
    <div id="keySetup" class="bg-white p-8 rounded-3xl shadow-2xl border border-indigo-100 mb-6">
        <div class="flex items-center gap-4 mb-6">
            <div class="w-12 h-12 bg-indigo-600 rounded-2xl flex items-center justify-center text-white shadow-lg shadow-indigo-200">
                <i class="fa-solid fa-key text-xl"></i>
            </div>
            <div class="text-left">
                <h3 class="font-bold text-lg text-slate-900">ê°œì¸ API í‚¤ ì—°ê²°</h3>
                <p class="text-xs text-slate-400">ë³´ì•ˆì„ ìœ„í•´ ë³¸ì¸ì˜ Gemini API í‚¤ë¥¼ ì…ë ¥í•´ì•¼ ëŒ€í™”ê°€ ì‹œì‘ë©ë‹ˆë‹¤.</p>
            </div>
        </div>
        
        <div class="flex flex-col gap-3">
            <input type="password" id="apiKeyInput" class="w-full bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 text-sm outline-none focus:ring-2 focus:ring-indigo-500 transition-all" placeholder="êµ¬ê¸€ AI Studioì—ì„œ ë°œê¸‰ë°›ì€ í‚¤ë¥¼ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”">
            <button id="saveKeyBtn" class="w-full bg-indigo-600 text-white px-6 py-3 rounded-xl font-bold text-sm hover:bg-indigo-700 transition-all shadow-lg active:scale-95">ì‹œì‘í•˜ê¸°</button>
        </div>
        
        <div class="mt-6 bg-indigo-50 p-4 rounded-xl flex items-center justify-between">
            <span class="text-xs text-indigo-800 font-medium">ì•„ì§ API í‚¤ê°€ ì—†ìœ¼ì‹ ê°€ìš”? (ë¬´ë£Œ ë°œê¸‰)</span>
            <a href="https://aistudio.google.com/app/apikey" target="_blank" class="text-xs bg-white text-indigo-600 px-3 py-1.5 rounded-lg border border-indigo-200 font-bold hover:bg-indigo-50 transition-colors">
                í‚¤ ë°œê¸‰ë°›ê¸° <i class="fa-solid fa-up-right-from-square ml-1 text-[10px]"></i>
            </a>
        </div>
    </div>

    <!-- Chat Interface (Hidden by default) -->
    <div id="mainChat" class="hidden glass-morphism rounded-3xl shadow-2xl border border-slate-200 overflow-hidden">
        <div id="chatWindow" class="chat-container overflow-y-auto p-6 space-y-6 bg-white/50">
            <div class="flex items-start gap-3 text-left">
                <div class="w-10 h-10 rounded-2xl bg-slate-900 flex items-center justify-center text-white text-lg shadow-lg shrink-0"><i class="fa-solid fa-robot text-sm"></i></div>
                <div class="bg-white border border-slate-200 p-4 rounded-2xl rounded-tl-none shadow-sm max-w-[85%] text-sm leading-relaxed">
                    ì¤€ë¹„ê°€ ë˜ì…¨ë‚˜ìš”? ì‘ì„±í•˜ì‹  **ê²½í—˜ ë¶„ì„ ì‹œíŠ¸ì˜ ë‚´ìš©**ì„ ì•„ë˜ì— ì…ë ¥í•´ ì£¼ì„¸ìš”. <br><br>
                    ì €ëŠ” ì—¬ëŸ¬ë¶„ì˜ ë…¼ë¦¬ì  í—ˆì ì„ íŒŒê³ ë“œëŠ” ì‹œë‹ˆì–´ ë©´ì ‘ê´€ì…ë‹ˆë‹¤. ë‹¨ìˆœí•œ ì¹­ì°¬ë³´ë‹¤ëŠ” ë‚ ì¹´ë¡œìš´ ì§ˆë¬¸ì— ë‹µí•˜ë©° ì—¬ëŸ¬ë¶„ì˜ ì‹¤ë ¥ì„ ì¦ëª…í•´ ë³´ì„¸ìš”.
                </div>
            </div>
        </div>

        <div class="p-4 bg-white border-t border-slate-100">
            <div class="flex gap-2 bg-slate-100 p-2 rounded-2xl focus-within:ring-2 focus-within:ring-indigo-500 transition-all">
                <textarea id="userInput" rows="2" class="flex-1 bg-transparent border-none px-4 py-2 focus:ring-0 resize-none outline-none text-sm" placeholder="ì—¬ê¸°ì— ê²½í—˜ ë¶„ì„ ë‚´ìš©ì„ ë³µì‚¬í•´ ë„£ìœ¼ì„¸ìš”..."></textarea>
                <button id="sendBtn" class="bg-indigo-600 text-white w-12 h-12 rounded-xl hover:bg-indigo-700 flex items-center justify-center shadow-lg transition-all active:scale-95">
                    <i class="fa-solid fa-paper-plane"></i>
                </button>
            </div>
            <p class="mt-3 text-[10px] text-slate-400 text-center"><i class="fa-solid fa-circle-info mr-1 text-[9px]"></i> ì§ˆë¬¸ì— ë‹µí• ìˆ˜ë¡ ì—¬ëŸ¬ë¶„ì˜ ì‚¬ê³ ë ¥ê³¼ ë©´ì ‘ ëŒ€ì‘ ëŠ¥ë ¥ì´ í–¥ìƒë©ë‹ˆë‹¤.</p>
        </div>
    </div>
</div>

<script type="module">
    let apiKey = "AIzaSyBRvfomIdo1XbzVgzL9hxMXBo-MBtjyQyU";
    const keySetup = document.getElementById('keySetup');
    const mainChat = document.getElementById('mainChat');
    const apiKeyInput = document.getElementById('apiKeyInput');
    const saveKeyBtn = document.getElementById('saveKeyBtn');
    const chatWindow = document.getElementById('chatWindow');
    const userInput = document.getElementById('userInput');
    const sendBtn = document.getElementById('sendBtn');

    saveKeyBtn.addEventListener('click', () => {
        const val = apiKeyInput.value.trim();
        if (val && val.length > 20) {
            apiKey = val;
            keySetup.classList.add('hidden');
            mainChat.classList.remove('hidden');
        } else {
            const msg = document.createElement('p');
            msg.className = "text-red-500 text-xs mt-2 text-left";
            msg.innerText = "ì˜¬ë°”ë¥¸ API í‚¤ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.";
            apiKeyInput.parentElement.appendChild(msg);
            setTimeout(() => msg.remove(), 2000);
        }
    });

    const systemPrompt = `ë‹¹ì‹ ì€ IT ê¸°ì—…ì˜ ê¹Œë‹¤ë¡œìš´ ì‹œë‹ˆì–´ ê¸°ìˆ  ë©´ì ‘ê´€ì…ë‹ˆë‹¤. ì‚¬ìš©ìê°€ ì œì¶œí•œ í”„ë¡œì íŠ¸ ê²½í—˜ ë¶„ì„ ë‚´ìš©ì„ ë³´ê³ , ë…¼ë¦¬ì  í—ˆì ì„ ì°¾ì•„ ê¼¬ë¦¬ ì§ˆë¬¸ì„ ë˜ì§€ì„¸ìš”. 
    ìƒí˜¸ì‘ìš© ê·œì¹™:
    1. ì‚¬ìš©ìì˜ ê¸€ì„ ì¹­ì°¬í•˜ê±°ë‚˜ ë‹¤ë“¬ì–´ì£¼ì§€ ë§ˆì„¸ìš”.
    2. "ì™œ ê·¸ ê¸°ìˆ ì¸ê°€?", "ëŒ€ì•ˆì€ ì—†ì—ˆë‚˜?", "ë³¸ì¸ì˜ ê¸°ì—¬ë„ëŠ” ì •í™•íˆ ì–´ë””ê¹Œì§€ì¸ê°€?" ë“± ë‚ ì¹´ë¡œìš´ ì§ˆë¬¸ì„ í•œ ë²ˆì— 'í•˜ë‚˜'ì”©ë§Œ í•˜ì„¸ìš”.
    3. ì‚¬ìš©ìê°€ ë‹µë³€í•˜ë©´ ê·¸ ë‹µë³€ ì†ì˜ ëª¨ìˆœì´ë‚˜ ì¶”ê°€ ê¶ê¸ˆì¦ì„ ë‹¤ì‹œ ì§ˆë¬¸í•˜ì„¸ìš”.
    4. ì‚¬ê³ ë ¥ê³¼ ë¬¸ì œ í•´ê²° ê·¼ê±°ë¥¼ ì§‘ìš”í•˜ê²Œ íŒŒí—¤ì¹˜ì„¸ìš”.
    5. ì–´íˆ¬ëŠ” ì •ì¤‘í•˜ì§€ë§Œ ë§¤ìš° ì°¨ê°‘ê³  ë¹„íŒì ì¸ í†¤ì„ ìœ ì§€í•˜ì„¸ìš”.`;

    async function fetchAIResponse(userText) {
        const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
        const payload = { 
            contents: [{ parts: [{ text: userText }] }], 
            systemInstruction: { parts: [{ text: systemPrompt }] } 
        };

        let delay = 1000;
        for (let i = 0; i < 5; i++) {
            try {
                const response = await fetch(url, { 
                    method: 'POST', 
                    headers: { 'Content-Type': 'application/json' }, 
                    body: JSON.stringify(payload) 
                });
                const data = await response.json();
                if (data.error) throw new Error(data.error.message);
                return data.candidates?.[0]?.content?.parts?.[0]?.text || "ì§ˆë¬¸ì„ ìƒì„±í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.";
            } catch (error) {
                if (i === 4) return "API í‚¤ê°€ ì˜ëª»ë˜ì—ˆê±°ë‚˜ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. í‚¤ë¥¼ í™•ì¸í•˜ê³  ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.";
                await new Promise(res => setTimeout(res, delay));
                delay *= 2;
            }
        }
    }

    function addMessage(text, isUser = false) {
        const div = document.createElement('div');
        div.className = isUser ? 'flex justify-end' : 'flex items-start gap-3 text-left';
        div.innerHTML = isUser 
            ? `<div class="bg-indigo-600 text-white p-4 rounded-2xl rounded-tr-none shadow-md max-w-[85%] text-sm leading-relaxed">${text}</div>`
            : `<div class="w-10 h-10 rounded-2xl bg-slate-900 flex items-center justify-center text-white text-lg shadow-lg shrink-0"><i class="fa-solid fa-robot text-sm"></i></div>
               <div class="bg-white border border-slate-200 p-4 rounded-2xl rounded-tl-none shadow-sm max-w-[85%] text-sm whitespace-pre-wrap leading-relaxed">${text}</div>`;
        chatWindow.appendChild(div);
        chatWindow.scrollTop = chatWindow.scrollHeight;
    }

    sendBtn.addEventListener('click', async () => {
        const text = userInput.value.trim();
        if (!text) return;

        addMessage(text, true);
        userInput.value = '';

        const loadingId = 'loading-' + Date.now();
        const loading = document.createElement('div');
        loading.id = loadingId;
        loading.className = 'text-[11px] text-slate-400 italic ml-14 flex items-center gap-2 text-left';
        loading.innerHTML = '<span class="loading-dots text-indigo-500 font-bold">ë©´ì ‘ê´€ì´ ì§ˆë¬¸ì„ ê²€í†  ì¤‘ì…ë‹ˆë‹¤</span>';
        chatWindow.appendChild(loading);
        chatWindow.scrollTop = chatWindow.scrollHeight;

        const aiRes = await fetchAIResponse(text);
        
        const loadingEl = document.getElementById(loadingId);
        if (loadingEl) chatWindow.removeChild(loadingEl);
        
        addMessage(aiRes);
    });

    userInput.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' && !e.shiftKey) {
            e.preventDefault();
            sendBtn.click();
        }
    });
</script>
</body>
</html>
